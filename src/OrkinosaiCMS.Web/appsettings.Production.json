{
  "_comment": "PRODUCTION CONFIGURATION: This file contains production-specific settings. This file is loaded when ASPNETCORE_ENVIRONMENT=Production.",
  "_deploymentNote": "CRITICAL: Production database credentials are NOT stored in source control. Connection string MUST be configured in Azure App Service Configuration. See AZURE_APP_SERVICE_CONFIGURATION_REQUIRED.md for setup instructions.",
  "_securityWarning": "SECURITY: As of December 22, 2025, production credentials have been removed from source control. Configure connection string in Azure Portal > App Service > Configuration > Connection Strings. See AZURE_APP_SERVICE_CONFIGURATION_REQUIRED.md for detailed instructions.",
  "_startupBehavior": "On startup with AutoApplyMigrations=true, the application will: 1) Connect to SQL Server using DefaultConnection from Azure App Service Configuration, 2) Automatically apply all pending migrations, 3) Create required tables (AspNetUsers, AspNetRoles, etc.), 4) Seed default admin user, 5) Start accepting requests. If connection string is missing or invalid, the application will log detailed error messages and refuse to start (HTTP 500.30).",
  "Logging": {
    "LogLevel": {
      "Default": "Warning",
      "Microsoft.AspNetCore": "Information"
    }
  },
  "Serilog": {
    "MinimumLevel": {
      "Default": "Error",
      "Override": {
        "Microsoft.AspNetCore": "Warning"
      }
    },
    "WriteTo": [
      {
        "Name": "Console",
        "Args": {
          "outputTemplate": "[{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz}] [{Level:u3}] [{SourceContext}] {Message:lj}{NewLine}{Exception}"
        }
      }
    ],
    "Enrich": [ "FromLogContext", "WithMachineName", "WithThreadId" ]
  },
  "AllowedHosts": "*",
  "DatabaseEnabled": true,
  "DatabaseProvider": "SqlServer",
  "Database": {
    "AutoApplyMigrations": true,
    "_autoApplyMigrationsNote": "For production with strict change control, set Database__AutoApplyMigrations=false via environment variable and apply migrations manually during deployment."
  },
  "ConnectionStrings": {
    "_comment": "PRODUCTION DATABASE CONNECTION: MUST BE CONFIGURED IN AZURE APP SERVICE CONFIGURATION",
    "_required": "This connection string MUST be configured in Azure Portal > App Service > Configuration > Connection Strings. DO NOT commit production credentials to source control.",
    "_securityNote": "CRITICAL: Production credentials should NEVER be in source control. Configure in Azure App Service Configuration or use Azure Key Vault.",
    "_azureConfiguration": "To configure in Azure: 1) Go to Azure Portal > Your App Service > Configuration > Connection Strings, 2) Add 'DefaultConnection' with Type 'SQLServer', 3) Enter your actual connection string, 4) Click Save",
    "_poolingSettings": "IMPORTANT: Include connection pooling settings to prevent HTTP 503 errors. Recommended: Max Pool Size=100, Min Pool Size=5, Pooling=true. These are automatically applied if not present in the connection string.",
    "_troubleshooting": {
      "error_40": "If you see 'error 40 - Could not open a connection to SQL Server', verify: 1) Server name is correct and accessible, 2) Firewall allows connections, 3) SQL Server is running",
      "error_500_30": "HTTP 500.30 startup errors indicate connection string issues or missing migrations. Check logs for specific SQL errors.",
      "error_503": "HTTP 503 Service Unavailable errors can be caused by connection pool exhaustion. Ensure Max Pool Size is set appropriately (default: 100) and connections are properly disposed of.",
      "access_denied": "Win32Exception Access Denied (error 5) means Windows authentication failed or service account lacks permissions. Use SQL authentication with User ID/Password instead.",
      "migrations": "Database migrations run automatically on startup when AutoApplyMigrations=true. Essential tables (AspNetUsers, etc.) will be created during first startup.",
      "missing_connection_string": "If connection string is missing, configure it in Azure App Service Configuration > Connection Strings. See AZURE_APP_SERVICE_CONFIGURATION_REQUIRED.md for detailed instructions."
    },
    "_exampleAzureSQL": "Server=tcp:yourserver.database.windows.net,1433;Initial Catalog=YourDatabase;Persist Security Info=False;User ID=yourusername;Password=yourpassword;MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;Max Pool Size=100;Min Pool Size=5;Pooling=true",
    "_exampleLocalSQL": "Server=YOUR_SERVER_NAME;Database=YOUR_DATABASE;User ID=YOUR_USERNAME;Password=YOUR_PASSWORD;Encrypt=True;TrustServerCertificate=True;MultipleActiveResultSets=True;Connection Timeout=30;Max Pool Size=100;Min Pool Size=5;Pooling=true",
    "_exampleSQLExpress": "Server=localhost\\SQLEXPRESS;Database=OrkinosaiCMS_Production;User ID=sa;Password=YOUR_SA_PASSWORD;Encrypt=True;TrustServerCertificate=True;MultipleActiveResultSets=True;Max Pool Size=100;Min Pool Size=5;Pooling=true",
    "DefaultConnection": ""
  },
  "CMS": {
    "SiteName": "Mosaic CMS",
    "DefaultTheme": "Default",
    "EnableModuleDiscovery": false,
    "AllowRegistration": false
  },
  "Authentication": {
    "_comment": "Production OAuth credentials MUST be set via Azure App Service Configuration or Environment Variables for security. NEVER commit production credentials to source control.",
    "Google": {
      "ClientId": "",
      "ClientSecret": ""
    }
  },
  "ErrorHandling": {
    "ShowDetailedErrors": false,
    "IncludeStackTrace": false
  }
}
